# Лабораторные работы №1-3 (Управление IT-проектами) #

Выполнил: Петрушин Влад, М8О-103М-20

## Сборка проекта ##

```bash
cmake configure .
cmake --build ./
```

## Запуск Docker-окружения ##

```bash
sudo docker-compose up -d
```

## Создание скрипта для заполнения шардов ##

```bash
./gen_data_sharding
```

Данный исполняемый файл генерирует скрипт gen_data_sharding.sql.

## Настройка базы данных ##

1. Создание таблицы Person на каждом из трех шардов.
2. Заполнение базы данных с помощью сгенерированного скрипта.

```bash
mysql -u test -p pzjqUkMnc7vfNHET -h 127.0.0.1 -P 6033 --comments
mysql> source shard_init.sql;
mysql> source gen_data_sharding.sql;
```

Удаление данных с узлов выполняется с помощью следующей команды:

```bash
mysql> source shard_clean.sql;
```

## Запуск сервера ##

Для запуска сервера следует выполнить команду:

```bash
sudo sh ./start.sh
```

Сервер работает на порту 8080.

## Модульное тестирование ##

Запуск модульных тестов осуществляется следующей командой:

```bash
./gtests
```

Для тестирования используется исходная таблица Person с последующей очисткой данных в каждом шарде по окончании работы gtests.

## Нагрузочное тестирование (wrk) ##

Нагрузочное тестирование производилось для 1, 2, 6 и 10 потоков при 50 подключениях в течение 30 секунд:

```bash
wrk -t <количество потоков> -c 50 -d 30s http://localhost:8080/person?login=123-47-3700
```

- Threads - количество потоков;
- Requests/sec - количество запросов в секунду;
- Latency(ms) - задержка в миллисекундах.

Threads | Requests/sec   | Latency(ms)
---     | ---            | ---
1       | 2788.10        | 6.13
2       | 3210.25        | 4.92
6       | 2924.30        | 5.27
10      | 2756.73        | 5.74